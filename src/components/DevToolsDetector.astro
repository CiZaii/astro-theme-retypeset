---
---

<div id="devtools-warning" class="devtools-warning hidden">
  <div class="warning-content">
    <span>è®¨åŒï¼Œåˆ«æ‰’åˆ«äººåº•è£¤ï¼</span>
  </div>
</div>

<script>
// é˜²æ­¢å¼€å‘è€…å·¥å…·æ£€æµ‹
let isDevToolsOpen = false
let warningElement: HTMLElement | null = null
let lastWarningTime = 0
const WARNING_COOLDOWN = 1000 // 5ç§’å†·å´æ—¶é—´

function showWarning() {
  const now = Date.now()
  if (now - lastWarningTime < WARNING_COOLDOWN) {
    return // é¿å…é¢‘ç¹è§¦å‘
  }

  if (!warningElement) {
    warningElement = document.getElementById('devtools-warning')
  }

  if (warningElement && !isDevToolsOpen) {
    isDevToolsOpen = true
    lastWarningTime = now
    warningElement.classList.remove('hidden')
    warningElement.classList.add('show')

    // 3ç§’åæ¸å˜æ¶ˆå¤±
    setTimeout(() => {
      if (warningElement) {
        warningElement.classList.add('fade-out')

        // åŠ¨ç”»ç»“æŸåéšè—å…ƒç´ 
        setTimeout(() => {
          if (warningElement) {
            warningElement.classList.remove('show', 'fade-out')
            warningElement.classList.add('hidden')
            isDevToolsOpen = false
          }
        }, 500) // æ¸å˜åŠ¨ç”»æŒç»­æ—¶é—´
      }
    }, 3000)
  }
}

// æ–¹æ³•1: æ£€æµ‹çª—å£å°ºå¯¸å˜åŒ–ï¼ˆå½“å¼€å‘è€…å·¥å…·æ‰“å¼€æ—¶çª—å£å°ºå¯¸ä¼šå˜åŒ–ï¼‰
let windowHeight = window.innerHeight
let windowWidth = window.innerWidth
let isInitialLoad = true

function detectDevTools() {
  // å¿½ç•¥åˆå§‹åŠ è½½æ—¶çš„å°ºå¯¸å˜åŒ–
  if (isInitialLoad) {
    isInitialLoad = false
    return
  }

  const heightRatio = window.innerHeight / windowHeight
  const widthRatio = window.innerWidth / windowWidth

  // å¦‚æœçª—å£å°ºå¯¸æ˜¾è‘—å‡å°‘ï¼Œå¯èƒ½æ˜¯å¼€å‘è€…å·¥å…·æ‰“å¼€äº†
  if (heightRatio < 0.75 || widthRatio < 0.75) {
    showWarning()
  }

  windowHeight = window.innerHeight
  windowWidth = window.innerWidth
}

// æ–¹æ³•2: ä½¿ç”¨æ€§èƒ½æ£€æµ‹
function detectDevToolsByTiming() {
  const start = performance.now()
  // ä½¿ç”¨try-catché¿å…consoleç›¸å…³çš„æ£€æµ‹è¢«ESLinté˜»æ­¢
  try {
    // eslint-disable-next-line no-console
    console.clear()
  }
  catch {
    // å¿½ç•¥é”™è¯¯
  }
  const end = performance.now()

  // å¦‚æœconsole.clear()æ‰§è¡Œæ—¶é—´å¼‚å¸¸é•¿ï¼Œå¯èƒ½å¼€å‘è€…å·¥å…·å·²æ‰“å¼€
  if (end - start > 1) {
    showWarning()
  }
}

// æ–¹æ³•3: æ£€æµ‹DevToolsç‰¹æœ‰è¡Œä¸º
const devtools = {
  open: false,
  orientation: null,
}

function detectDevToolsAdvanced() {
  const threshold = 160

  if (window.outerHeight - window.innerHeight > threshold
    || window.outerWidth - window.innerWidth > threshold) {
    if (!devtools.open) {
      devtools.open = true
      showWarning()
    }
  }
  else {
    devtools.open = false
  }
}

// å¯åŠ¨æ£€æµ‹
setTimeout(() => {
  // ç›‘å¬çª—å£å˜åŒ–
  window.addEventListener('resize', detectDevTools)

  // å®šæœŸæ£€æµ‹
  setInterval(detectDevToolsByTiming, 2000)
  setInterval(detectDevToolsAdvanced, 1000)
}, 2000) // 2ç§’åå¼€å§‹æ£€æµ‹ï¼Œé¿å…é¡µé¢åŠ è½½æ—¶çš„å¹²æ‰°

// ç›‘å¬é”®ç›˜äº‹ä»¶ï¼ˆF12, Ctrl+Shift+I, Ctrl+Shift+J, Ctrl+Uï¼‰
document.addEventListener('keydown', (e) => {
  if (
    e.key === 'F12'
    || (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'J' || e.key === 'C'))
    || (e.ctrlKey && e.key === 'u')
    || (e.metaKey && e.altKey && (e.key === 'i' || e.key === 'I')) // Macå¿«æ·é”®
  ) {
    e.preventDefault()
    showWarning()
    return false
  }
})

// ç¦ç”¨å³é”®èœå•
document.addEventListener('contextmenu', (e) => {
  e.preventDefault()
  showWarning()
  return false
})

// é˜²æ­¢é€‰æ‹©å’Œå¤åˆ¶ï¼ˆä½†ä¿ç•™ä»£ç å—çš„é€‰æ‹©åŠŸèƒ½ï¼‰
document.addEventListener('selectstart', (e) => {
  const target = e.target as Element
  if (target && !target.closest('pre, code, .selectable, input, textarea')) {
    e.preventDefault()
    return false
  }
})

// ç¦ç”¨æ‹–æ‹½
document.addEventListener('dragstart', (e) => {
  const target = e.target as Element
  if (target && !target.closest('img, .draggable')) {
    e.preventDefault()
    return false
  }
})

// åè°ƒè¯•ï¼šæ£€æµ‹è°ƒè¯•å™¨æ–­ç‚¹
function antiDebugger() {
  try {
    const start = performance.now()
    // eslint-disable-next-line no-debugger
    debugger
    const end = performance.now()

    if (end - start > 100) {
      showWarning()
    }
  }
  catch {
    // å¿½ç•¥é”™è¯¯
  }
}

// éšæœºé—´éš”è¿è¡Œåè°ƒè¯•
function scheduleAntiDebugger() {
  const delay = Math.random() * 3000 + 1000 // 1-4ç§’éšæœºé—´éš”
  setTimeout(() => {
    antiDebugger()
    scheduleAntiDebugger()
  }, delay)
}

// å¯åŠ¨åè°ƒè¯•ï¼ˆå»¶è¿Ÿå¯åŠ¨ï¼‰
setTimeout(scheduleAntiDebugger, 3000)
</script>

<style>
  .devtools-warning {
    position: fixed;
    top: 20px;
    left: 20px;
    z-index: 9999;
    background: linear-gradient(135deg, #ff6b6b 0%, #ff8787 50%, #ee5a52 100%);
    color: white;
    padding: 16px 24px;
    border-radius: 12px;
    box-shadow:
      0 8px 32px rgba(255, 107, 107, 0.3),
      0 2px 8px rgba(0, 0, 0, 0.1);
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Noto Sans', sans-serif;
    font-size: 15px;
    font-weight: 600;
    line-height: 1.4;
    transform: translateX(-100%);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 1px solid rgba(255, 255, 255, 0.3);
    backdrop-filter: blur(8px);
    max-width: 280px;
    animation: pulse 2s infinite;
  }

  .devtools-warning.show {
    transform: translateX(0);
    animation: slideInBounce 0.6s cubic-bezier(0.68, -0.55, 0.265, 1.55);
  }

  .devtools-warning.fade-out {
    opacity: 0;
    transform: translateX(-30px) scale(0.95);
    transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .devtools-warning.hidden {
    display: none;
  }

  .warning-content {
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .warning-content::before {
    content: 'ğŸ™ˆ';
    font-size: 20px;
    animation: wiggle 1s ease-in-out infinite;
  }

  /* åŠ¨ç”»æ•ˆæœ */
  @keyframes slideInBounce {
    0% {
      transform: translateX(-100%);
      opacity: 0;
    }
    50% {
      transform: translateX(10px);
    }
    100% {
      transform: translateX(0);
      opacity: 1;
    }
  }

  @keyframes pulse {
    0%, 100% {
      box-shadow:
        0 8px 32px rgba(255, 107, 107, 0.3),
        0 2px 8px rgba(0, 0, 0, 0.1);
    }
    50% {
      box-shadow:
        0 12px 40px rgba(255, 107, 107, 0.4),
        0 4px 12px rgba(0, 0, 0, 0.15);
    }
  }

  @keyframes wiggle {
    0%, 100% {
      transform: rotate(0deg);
    }
    25% {
      transform: rotate(-10deg) scale(1.1);
    }
    75% {
      transform: rotate(10deg) scale(1.1);
    }
  }

  /* å“åº”å¼è®¾è®¡ */
  @media (max-width: 480px) {
    .devtools-warning {
      top: 10px;
      left: 10px;
      right: 10px;
      max-width: none;
      padding: 14px 18px;
      font-size: 14px;
    }
  }

  /* æ·±è‰²æ¨¡å¼é€‚é… */
  @media (prefers-color-scheme: dark) {
    .devtools-warning {
      background: linear-gradient(135deg, #ff4757 0%, #ff6b7a 50%, #c44569 100%);
      border-color: rgba(255, 255, 255, 0.2);
    }
  }

  /* åè°ƒè¯•æªæ–½ - é™åˆ¶ç”¨æˆ·é€‰æ‹© */
  body {
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-touch-callout: none;
    -webkit-tap-highlight-color: transparent;
  }

  /* å…è®¸ä»£ç å—ã€è¾“å…¥æ¡†å’ŒæŸäº›ç‰¹æ®Šå…ƒç´ å¯ä»¥é€‰æ‹© */
  pre,
  code,
  .selectable,
  input,
  textarea,
  [contenteditable="true"] {
    -webkit-user-select: text !important;
    -moz-user-select: text !important;
    -ms-user-select: text !important;
    user-select: text !important;
  }

  /* ä¸ºåšå®¢æ–‡ç« å†…å®¹æ·»åŠ å¯é€‰æ‹©æ€§ */
  article,
  .post-content,
  .content,
  .markdown-body {
    -webkit-user-select: text !important;
    -moz-user-select: text !important;
    -ms-user-select: text !important;
    user-select: text !important;
  }

  /* å›¾ç‰‡ä¿æŠ¤ */
  img {
    -webkit-user-drag: none;
    -moz-user-drag: none;
    -ms-user-drag: none;
    user-drag: none;
    pointer-events: none;
  }

  /* å…è®¸å¯æ‹–æ‹½å…ƒç´ æ­£å¸¸å·¥ä½œ */
  .draggable img,
  .image-zoom img {
    pointer-events: auto;
    -webkit-user-drag: auto;
    -moz-user-drag: auto;
    -ms-user-drag: auto;
    user-drag: auto;
  }
</style>
